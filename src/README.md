# User Guide

## Files

**ver.sh** - edit this file before running any Makefile targets. See
epm-helpers script mkver.pl and the Makefile to see how the
env. vars. will be used.

**Makefile** - This is the main file for managing the build and packaging steps.

**epm.inc** - this is the "top" EPM definition file. It includes other files.

**ver-ubuntu18.require** - This defines required package for
ubuntu18. Each OS version may have different required package names.

**patch.dat** - this is the input file for epm-helpers script
patch-epm-list.  Mainly it will remove pseudo root dirs that are not
managed by the davinci-installer package.

**VERSION** - 'make release' will append the version and date stamp to
  this file.

**LICENSE** - GPL license. If you fork and make changes, the changes
should be shared back.

**davinci-rm.sh** - Use this script if you used the installer in the zip file.

**CVS/** - you can ignore this. I still use CVS "local" versioning.

**.cvsignore** - you cna ignore this.

---

## Initial Setup

### Install Dependencies
* Install
[EPM - ESP Package Manager / Software Packaging Tool](https://jimjag.github.io/epm/)
and [https://github.com/jimjag/epm](https://github.com/jimjag/epm)

* Install EPM Helpers. See:
[https://github.com/TurtleEngr/epm-helpers](https://github.com/TurtleEngr/epm-helpers)

### Edit ver.sh

Define these vars:

* **ProdName** - Change if desired.

* **ProdVer** - this to the version number that will be used for your
installer. It should be the same as the zip file version, but it could
be different.

* **ProdTPVer** - Set this to the version number of the zip file, so
that it matches this kind of pattern:
"DaVinci_Resolve_$(mVer)_Linux". mVer will be set to this variable.

* **ProdRelServer** - server domain name

* **ProdRelRoot** - top release directory

* **ProdRelCategory** - directory under 'released' or 'development'

These are vars are generated. Run 'make ver.env', then check the
values in ver.env

* **ProdRelDir** - this is generated

* **ProdOS** - this is generated by mkver.pl Run 'make ver.env' to check.

* **ProdArch** - this is generated by mkver.pl Run 'make ver.env' to check.

### Edit Makefile

* Define **mArchive** - the location for the DaVinci_Resolve zip files

* Redefine **mTop** - if you don't like the /opt/resolve for the
location of DaVinci_Resolve. If you change this, you will also need to
update patch.dat

* Change **mDesktopDir** - if the path is not correct.

### Download the latest DaVinci_Resolve zip

From:
[https://www.blackmagicdesign.com/products/davinciresolve/](https://www.blackmagicdesign.com/products/davinciresolve/)
- Select Linux.  (If downloading DaVinci_Resolve_Studio, there is a
link at the bottome of the registration page to "download only").

Put the zip file in the mArchive location.

### Note: Building DaVinci_Resolve_Studio

This has not been implemented.

The **mDVPkg** variable setting implies you are building the free
version of DaVinci_Resolve. 99% of this code can be used to build
an installer for DaVinci_Resolve_Studio. To do that, there is a design
decision:

1) Use a "control" variable to manage which one is being built. This
style creates conditional sections across the code.

2) Create different definition files. The Makefile will select the
correct definition file, based on the top build target selected.

3) Use a bit of both. Wherever possible use explicit variable values,
not control variable as selectors. To set different values for
different installers, the selection needs to be made at the top most
level, by selecting different definition files.

---

## Build It

### make prepare

Make and check for dependencies. Install any missing dependencies.

### make build

Place all the files to be packaged in pseudo root dist/ dir. Verify
the files look OK.

#### make clean

If build or package fails, you can cleanup dist and other tmp areas.

### make package

Build the package. The package will be put in the pkg/ dir.  If you
rebuild the package, increment the ProdBuild number.

### make release

This pushes the package to your distribution server (with rsync via
ssh).  This is your personal installer. This should not be made
"public".

### make dist-clean

Clean up all build files. Only commit the files that are left.
DO NOT commit "built" files.

### make help

This target will run the DaVinci_Resolve native installer with a -h
option, which will list the command line options it will accept. The
Unpack section of the Makefile used the "-extract" option to get all
of files bundled in the binary package. A newer installer could have
different options or very different ways of installing. If really
different, then the "build" process in the Makefile will need to be
changed to match the changes.

---

$Header: /repo/public.cvs/app/davinci-installer/github/src/README.md,v 1.4 2021/04/08 20:18:10 bruce Exp $
